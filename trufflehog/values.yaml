# Sets the number of pod replicas.
replicaCount: 1

image:
  repository: us-docker.pkg.dev/thog-artifacts/public/scanner
  tag: latest
  pullPolicy: Always

# The resources requests and limits for the TruffleHog Enterprise container.
resources:
  requests:
    memory: "16Gi"
    cpu: "4000m"
    ephemeralStorage: "10Gi"
  limits:
    enabled: true
    memory: "48Gi"
    cpu: "12000m"
    ephemeralStorage: "30Gi"

# A VerticalPodAutoscaler will adjust resource requests based on observed CPU and memory usage.
vpa:
  enabled: true
  minAllowed:
    cpu: "4000m"
    memory: "16Gi"
  maxAllowed:
    enabled: true
    memory: "48Gi"
    cpu: "12000m"

# Configures the Kubernetes secret that provides the application's configuration data.
config:
  secretName: config

# Persistence configuration for mounting storage volumes
# Supports multiple volume types: PersistentVolumeClaim, emptyDir, hostPath, and custom volumes
persistence:
  # Enable persistence
  enabled: false
  # Mount path for the volume inside the container
  mountPath: /data
  # Volume type: "pvc" (PersistentVolumeClaim), "emptyDir", "hostPath", or "custom"
  type: pvc
  # Configuration for PersistentVolumeClaim
  pvc:
    # Use an existing PersistentVolumeClaim (if specified, storageClass and size are ignored)
    existingClaim: ""
    # Storage class for dynamically provisioning PVC (empty string uses default)
    storageClass: ""
    # Storage size for dynamically provisioned PVC
    size: 10Gi
    # Access mode for the PVC
    accessMode: ReadWriteOnce
    # Additional labels for the PVC
    labels: {}
    # Additional annotations for the PVC
    annotations: {}
  # Configuration for emptyDir volume
  emptyDir: {}
    # Uncomment to set size limit (requires SizeMemoryBackedVolumes feature gate)
    # sizeLimit: 10Gi
  # Configuration for hostPath volume
  hostPath:
    path: ""
    type: ""
  # Custom volume specification (raw YAML, will be merged with name)
  # Use this for advanced volume types not covered above
  # Example for nfs:
  # custom:
  #   nfs:
  #     server: nfs.example.com
  #     path: /exported/path
  custom: {}

# Configures the CLI options for the scanner.
cli:
  debug: false
  quiet: false
  trace: false
  json: false

# Extra environment variables to add to the container
# Supports both direct values and valueFrom references to ConfigMaps and Secrets
# Examples:
# extraEnvVars:
#   # Direct value
#   - name: LOG_LEVEL
#     value: "debug"
#   # From ConfigMap key
#   - name: CONFIG_VALUE
#     valueFrom:
#       configMapKeyRef:
#         name: my-configmap
#         key: config-key
#         optional: false  # Optional: whether the ConfigMap/key must exist
#   # From Secret key
#   - name: API_KEY
#     valueFrom:
#       secretKeyRef:
#         name: my-secret
#         key: api-key
#         optional: false  # Optional: whether the Secret/key must exist
extraEnvVars: []

# Name of a ConfigMap containing additional environment variables
# The ConfigMap should contain key-value pairs that will be added as environment variables
extraEnvVarsCM: ""

# Name of a Secret containing additional environment variables
# The Secret should contain key-value pairs that will be added as environment variables
extraEnvVarsSecret: ""


probe:
  initialDelaySeconds: 3
  periodSeconds: 3

nameOverride: ""
fullnameOverride: ""

# Common labels to add to all resources
commonLabels: {}
  # environment: production
  # team: security

# Common annotations to add to all resources
commonAnnotations: {}
  # prometheus.io/scrape: "true"
  # prometheus.io/port: "8080"

# Additional labels to add to pods
podLabels: {}
  # security-scan: enabled
  # pod-type: scanner

# Additional annotations to add to pods
podAnnotations: {}
  # prometheus.io/scrape: "true"
  # prometheus.io/port: "8080"
  # prometheus.io/path: "/metrics"
  # vault.hashicorp.com/agent-inject: "true"
  # vault.hashicorp.com/role: "trufflehog"

priorityClass:
  create: true
  name: ""                # Existing priority class to use if create is false
  value: 1000             # Priority value, only used if create is true

# Taint tolerations for the pod
# Allows pods to be scheduled on nodes with matching taints
# Example:
# tolerations:
#   - key: "key"
#     operator: "Equal"
#     value: "value"
#     effect: "NoSchedule"
#   - key: "dedicated"
#     operator: "Exists"
#     effect: "NoSchedule"
tolerations: []

securityContext:
  # Pod-level security context
  pod:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000
  # Container-level security context
  container:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
